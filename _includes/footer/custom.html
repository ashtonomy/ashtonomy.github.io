<!-- start custom footer snippets -->

<a href="/sitemap/">Sitemap</a>

<!-- Support for MatJax -->
<script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>

<!-- Support for Mermaid -->
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    mermaid.initialize({startOnLoad:true, theme:'default'});
    await mermaid.run({querySelector:'code.language-mermaid'});
</script>

<!-- end custom footer snippets -->

<!-- Boids by Alfred Hitchcock -->

<!-- Load Three.js (required by Vanta) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>

<!-- Load Vanta Birds -->
<!-- <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.birds.min.js"></script> -->

<!-- Network animation -->
<script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>

<!-- <script>
window.addEventListener("load", function () {

  // ⬇ Patch START (you do NOT set values here)
  const NetProto = VANTA.NET.prototype;

  // Slow rotation patch
  NetProto.onMouseMove = function (t, e) {
    const sens = this.options.mouseSensitivity ?? 0.2;
    const cam = this.camera;

    if (!cam.oy) {
      cam.oy = cam.position.y;
      cam.ox = cam.position.x;
      cam.oz = cam.position.z;
    }

    const angle = Math.atan2(cam.oz, cam.ox);
    const radius = Math.sqrt(cam.oz**2 + cam.ox**2);

    const horiz = 2 * sens;
    const vert  = 50 * sens;

    const n = angle + horiz * (t - 0.5);
    cam.tz = radius * Math.sin(n);
    cam.tx = radius * Math.cos(n);
    cam.ty = cam.oy + vert * (e - 0.5);

    this.rcMouseX = 2 * t - 1;
    this.rcMouseY = 2 * e - 1;
  };

  // Density falloff patch
  const originalInit = NetProto.onInit;
  NetProto.onInit = function () {
    originalInit.call(this);

    const falloff = this.options.centerFalloff ?? 1.8;

    let maxR = 0;
    this.points.forEach(p => {
      const r = Math.sqrt(p.position.x**2 + p.position.z**2);
      p._r0 = r;
      if (r > maxR) maxR = r;
    });

    this.points.forEach(p => {
      const r0 = p._r0;
      if (!r0 || !maxR) return;
      const rNorm = r0 / maxR;
      const newNorm = Math.pow(rNorm, falloff);
      const newR = maxR * newNorm;
      const scale = newR / r0;

      p.position.x *= scale;
      p.position.z *= scale;
      p.ox *= scale;
      p.oz *= scale;
    });

    // Apply global opacity patch
    const alpha = this.options.networkAlpha ?? 0.35;

    this.points.forEach(p => {
      if (p.material) {
        p.material.transparent = true;
        p.material.opacity = alpha;
        p.material.needsUpdate = true;
      }
    });

    if (this.linesMesh?.material) {
      const mat = this.linesMesh.material;
      mat.transparent = true;
      mat.opacity = alpha;
      mat.depthWrite = false;
      mat.needsUpdate = true;
    }
  };
  // ⬆ Patch END

  // ⬇ THIS is where you set your parameters
  VANTA.NET({
    el: "#vanta-bg",
    color: 0xe5bbbb,
    backgroundColor: 0xffffff,

    mouseSensitivity: 0.05,
    centerFalloff: 1.8,
    networkAlpha: 0.35
  });
});
</script> -->

<!-- Your customization -->
<script>
window.addEventListener('load', function () {
  // 1) Create the Vanta effect normally
  const effect = VANTA.NET({
    el: "#vanta-bg",
    color: 0xe5bbbb,
    backgroundColor: 0xffffff,
    points: 9.00, // Default 10
    maxDistance: 19.00, // Default 20
    mouseSensitivity: 0.175, // lower = slower rotation
    networkAlpha: 0.5,     // lower = more subtle
    centerFalloff: 1.2     // >1 = denser center, sparser edges
  });

  // 2) Slow the mouse movement by wrapping onMouseMove
  const originalOnMouseMove = effect.onMouseMove.bind(effect);
  effect.onMouseMove = function (t, e) {
    const sens = this.options.mouseSensitivity ?? 0.2;

    // compress mouse coordinates toward the center
    const nx = 0.5 + (t - 0.5) * sens;
    const ny = 0.5 + (e - 0.5) * sens;

    originalOnMouseMove(nx, ny);
  };

  // 3) Apply alpha, density, and line color once everything is ready
  function applyVisualTweaks() {
    // Wait until Vanta has created points and lines
    if (!effect.points || !effect.linesMesh) {
      requestAnimationFrame(applyVisualTweaks);
      return;
    }

    const alpha   = effect.options.networkAlpha ?? 0.3;
    const falloff = effect.options.centerFalloff ?? 1.8;

    // 3a) Global alpha for dots
    effect.points.forEach(p => {
      if (p.material) {
        p.material.transparent = true;
        p.material.opacity = alpha;
        p.material.needsUpdate = true;
      }
    });

    // 3b) Global alpha for lines
    if (effect.linesMesh.material) {
      const m = effect.linesMesh.material;
      m.transparent = true;
      m.opacity = alpha;
      m.depthWrite = false;
      m.needsUpdate = true;
    }

    // 3c) Pull points toward center (denser middle, sparser edges)
    let maxR = 0;
    effect.points.forEach(p => {
      const r = Math.hypot(p.position.x, p.position.z);
      p._r0 = r;
      if (r > maxR) maxR = r;
    });

    if (maxR > 0) {
      effect.points.forEach(p => {
        const r0 = p._r0;
        if (!r0) return;
        const rNorm   = r0 / maxR;              // 0 = center, 1 = edge
        const newNorm = Math.pow(rNorm, falloff);
        const newR    = maxR * newNorm;
        const scale   = newR / r0;

        p.position.x *= scale;
        p.position.z *= scale;
        if (p.ox !== undefined) p.ox *= scale;
        if (p.oz !== undefined) p.oz *= scale;
      });
    }

    // 3d) Make line color match node color
    if (effect.linesMesh.geometry &&
        effect.linesMesh.geometry.attributes &&
        effect.linesMesh.geometry.attributes.color) {

      const col = new THREE.Color(effect.options.color);
      const arr = effect.linesMesh.geometry.attributes.color.array;

      for (let i = 0; i < arr.length; i += 3) {
        arr[i]     = col.r;
        arr[i + 1] = col.g;
        arr[i + 2] = col.b;
      }
      effect.linesMesh.geometry.attributes.color.needsUpdate = true;
    }
  }

  applyVisualTweaks();
});
</script>

<!-- <div id="vanta-bg" style="width:100%;height:100vh;"></div> -->

<!-- <script>
document.addEventListener("DOMContentLoaded", function () {
  VANTA.BIRDS({
    el: "#vanta-bg",
    mouseControls: true,
    touchControls: true,
    gyroControls: false,
    minHeight: 200.00,
    minWidth: 200.00,
    scale: 1.00,
    scaleMobile: 1.00,
    backgroundColor: 0xffffff,
    color1: 0x7883ff,
    color2: 0x7de7ff,
    colorMode: "lerp",
    wingSpan: 27.00,
    speedLimit: 3.00,
    separation: 51.00,
    alignment: 18.00,
    quantity: 4.00,
    backgroundAlpha: 0.16
  });
});
</script>
 -->
